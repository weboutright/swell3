<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swell Admin Dashboard - Complete Management Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%);
            overflow-x: hidden;
        }
        
        /* Premium gradient backgrounds */
        .premium-gradient {
            background: linear-gradient(135deg, #065f46 0%, #047857 50%, #059669 100%);
        }
        
        .dashboard-gradient {
            background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 50%, #ecfdf5 100%);
        }
        
        /* Sidebar styling */
        .sidebar {
            background: linear-gradient(135deg, rgba(6, 95, 70, 0.95) 0%, rgba(4, 120, 87, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .sidebar-item {
            transition: all 0.3s ease;
            border-radius: 12px;
            margin: 4px 0;
        }
        
        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(4px);
        }
        
        .sidebar-item.active {
            background: rgba(255, 255, 255, 0.2);
            border-left: 4px solid #10b981;
        }
        
        /* Enhanced cards with glass morphism */
        .admin-card { 
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%);
            box-shadow: 0 25px 50px rgba(4, 120, 87, 0.08), 0 0 0 1px rgba(255, 255, 255, 0.1);
        }

        /* Premium buttons with shine effect */
        .btn-premium {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            background-size: 200% 100%;
        }

        /* Typography enhancements */
        .premium-heading {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #064e3b 0%, #047857 50%, #059669 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .brand-font {
            font-family: 'Luckiest Guy', cursive;
        }
        
        /* Premium input styling */
        .premium-input {
            transition: all 0.3s ease;
            border: 2px solid rgba(16, 185, 129, 0.1);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
        
        .premium-input:focus {
            border-color: rgba(16, 185, 129, 0.5);
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
            background: rgba(255, 255, 255, 1);
        }

        /* Status styling */
        .status-success { 
            background: linear-gradient(135deg, #d1fae5 0%, #ecfdf5 100%); 
            color: #065f46; 
            border: 1px solid rgba(16, 185, 129, 0.2);
            backdrop-filter: blur(10px);
        }
        .status-error { 
            background: linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%); 
            color: #991b1b; 
            border: 1px solid rgba(239, 68, 68, 0.2);
            backdrop-filter: blur(10px);
        }

        /* Service card premium styling */
        .service-card {
            background: linear-gradient(135deg, rgba(236, 253, 245, 0.9) 0%, rgba(240, 253, 244, 0.7) 100%);
            border: 2px solid rgba(16, 185, 129, 0.2);
            backdrop-filter: blur(10px);
        }

        /* Booking status styling */
        .status-confirmed { 
            background: linear-gradient(135deg, #d1fae5 0%, #ecfdf5 100%); 
            color: #065f46; 
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        .status-pending { 
            background: linear-gradient(135deg, #fef3c7 0%, #fffbeb 100%); 
            color: #92400e; 
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        .status-cancelled { 
            background: linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%); 
            color: #991b1b; 
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        /* Availability styling */
        .availability-available { 
            background: linear-gradient(135deg, #dcfce7 0%, #f0fdf4 100%); 
            border: 2px solid rgba(34, 197, 94, 0.3);
        }
        .availability-blocked { 
            background: linear-gradient(135deg, #fecaca 0%, #fef2f2 100%); 
            border: 2px solid rgba(239, 68, 68, 0.3);
        }
        .availability-holiday { 
            background: linear-gradient(135deg, #ddd6fe 0%, #f5f3ff 100%); 
            border: 2px solid rgba(139, 92, 246, 0.3);
        }

        /* Chart container */
        .chart-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="dashboard-gradient" onload="lucide.createIcons()">

    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="sidebar w-64 p-6 fixed left-0 top-0 h-full z-50 shadow-2xl">
            <!-- Logo -->
            <div class="mb-8">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center mr-3">
                        <i data-lucide="waves" class="w-6 h-6 text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-black brand-font text-white">Swell</h1>
                        <p class="text-emerald-200 text-xs">Admin Dashboard</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="space-y-2">
                <a href="javascript:void(0)" class="sidebar-item active flex items-center p-3 text-white" onclick="showSection('system-config', this)">
                    <i data-lucide="settings" class="w-5 h-5 mr-3"></i>
                    <span class="font-medium">System Configuration</span>
                </a>
                <a href="javascript:void(0)" class="sidebar-item flex items-center p-3 text-white" onclick="showSection('analytics', this)">
                    <i data-lucide="trending-up" class="w-5 h-5 mr-3"></i>
                    <span class="font-medium">Weekly Analytics</span>
                </a>
                <a href="javascript:void(0)" class="sidebar-item flex items-center p-3 text-white" onclick="showSection('calendar', this)">
                    <i data-lucide="calendar" class="w-5 h-5 mr-3"></i>
                    <span class="font-medium">Calendar View</span>
                </a>
                <a href="javascript:void(0)" class="sidebar-item flex items-center p-3 text-white" onclick="showSection('bookings', this)">
                    <i data-lucide="calendar-check" class="w-5 h-5 mr-3"></i>
                    <span class="font-medium">Manage Bookings</span>
                </a>
                <a href="javascript:void(0)" class="sidebar-item flex items-center p-3 text-white" onclick="showSection('availability', this)">
                    <i data-lucide="calendar-days" class="w-5 h-5 mr-3"></i>
                    <span class="font-medium">Business Hours</span>
                </a>
                <a href="javascript:void(0)" class="sidebar-item flex items-center p-3 text-white" onclick="showSection('holidays', this)">
                    <i data-lucide="calendar-x" class="w-5 h-5 mr-3"></i>
                    <span class="font-medium">Holidays & Blocks</span>
                </a>
                <a href="javascript:void(0)" class="sidebar-item flex items-center p-3 text-white" onclick="showSection('deployment', this)">
                    <i data-lucide="code" class="w-5 h-5 mr-3"></i>
                    <span class="font-medium">Deployment & Embed</span>
                </a>
            </nav>

            <!-- User Info -->
            <div class="absolute bottom-6 left-6 right-6">
                <div class="bg-white/10 rounded-xl p-4">
                    <div class="flex items-center">
                        <img id="user-avatar" src="" alt="User" class="w-10 h-10 rounded-full mr-3 border-2 border-white/30" style="display: none;">
                        <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center mr-3" id="user-avatar-placeholder">
                            <i data-lucide="user" class="w-5 h-5 text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-white font-semibold text-sm truncate" id="user-name">Loading...</p>
                            <p class="text-emerald-200 text-xs truncate" id="user-email">Administrator</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 ml-64 p-8 overflow-y-auto">
            
            <!-- System Configuration Section -->
            <div id="system-config" class="section-content">
                <!-- Welcome Banner -->
                <div class="admin-card p-8 rounded-3xl text-center mb-8">
                    <div class="flex justify-center mb-6">
                        <div class="w-20 h-20 premium-gradient rounded-2xl flex items-center justify-center shadow-xl">
                            <i data-lucide="crown" class="w-10 h-10 text-white"></i>
                        </div>
                    </div>
                    <h2 class="text-4xl font-black premium-heading mb-4">Welcome to Swell Admin</h2>
                    <p class="text-gray-600 text-lg max-w-2xl mx-auto">
                        Manage your booking automation platform with enterprise-grade controls. Configure services, customize payments, and deploy your booking widget with professional precision.
                    </p>
                </div>

                <!-- System Configuration Panel -->
                <section class="admin-card p-8 rounded-3xl mb-8">
                    <div class="flex items-center mb-8">
                        <div class="w-14 h-14 premium-gradient rounded-xl flex items-center justify-center shadow-lg mr-4">
                            <i data-lucide="settings" class="w-7 h-7 text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-3xl font-black premium-heading">System Configuration</h2>
                            <p class="text-gray-600">Core settings for your booking automation</p>
                        </div>
                    </div>
                    
                    <div class="space-y-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Calendar ID -->
                            <div class="space-y-2">
                                <label for="calendar-id" class="block text-sm font-bold text-gray-800 mb-2 flex items-center">
                                    <i data-lucide="calendar" class="w-4 h-4 mr-2 text-emerald-600"></i>
                                    Google Calendar ID
                                </label>
                                <input type="email" id="calendar-id" class="w-full p-4 premium-input rounded-xl focus:ring-emerald-500 focus:border-emerald-500 font-medium" placeholder="e.g., your-calendar-id@group.calendar.google.com" required>
                                <p class="text-xs text-gray-500 flex items-center mt-2">
                                    <i data-lucide="info" class="w-3 h-3 mr-1"></i>
                                    Primary calendar for availability checks and adding bookings
                                </p>
                            </div>
                            <!-- Admin Email -->
                            <div class="space-y-2">
                                <label for="admin-email" class="block text-sm font-bold text-gray-800 mb-2 flex items-center">
                                    <i data-lucide="shield" class="w-4 h-4 mr-2 text-emerald-600"></i>
                                    Admin Email (Security Key)
                                </label>
                                <input type="email" id="admin-email" class="w-full p-4 premium-input rounded-xl focus:ring-emerald-500 focus:border-emerald-500 font-medium" placeholder="e.g., your.business.email@gmail.com" required>
                                <p class="text-xs text-gray-500 flex items-center mt-2">
                                    <i data-lucide="info" class="w-3 h-3 mr-1"></i>
                                    Only this email can access this admin panel
                                </p>
                            </div>
                        </div>

                        <!-- Payment Processor Block -->
                        <div class="border-t border-emerald-100 pt-8 mt-8">
                            <div class="flex flex-col lg:flex-row gap-8">
                                <!-- Payment Processor Selection -->
                                <div class="lg:w-1/3">
                                    <label class="block text-sm font-bold text-gray-800 mb-4 flex items-center">
                                        <i data-lucide="credit-card" class="w-4 h-4 mr-2 text-emerald-600"></i>
                                        Payment Processor
                                    </label>
                                    <div class="space-y-4">
                                        <label class="flex items-center p-4 border-2 border-emerald-200 rounded-xl hover:border-emerald-400 transition-colors cursor-pointer">
                                            <input type="radio" name="payment-type" value="stripe" class="form-radio text-emerald-600 focus:ring-emerald-500 w-5 h-5" checked onchange="updatePaymentPlaceholder(this.value)">
                                            <div class="ml-4">
                                                <span class="text-gray-800 font-bold text-lg">Stripe</span>
                                                <p class="text-gray-500 text-sm">Global payment processing</p>
                                            </div>
                                        </label>
                                        <label class="flex items-center p-4 border-2 border-emerald-200 rounded-xl hover:border-emerald-400 transition-colors cursor-pointer">
                                            <input type="radio" name="payment-type" value="square" class="form-radio text-emerald-600 focus:ring-emerald-500 w-5 h-5" onchange="updatePaymentPlaceholder(this.value)">
                                            <div class="ml-4">
                                                <span class="text-gray-800 font-bold text-lg">Square</span>
                                                <p class="text-gray-500 text-sm">Point of sale & online payments</p>
                                            </div>
                                        </label>
                                        <input type="hidden" id="payment-processor-type" value="stripe"> 
                                    </div>
                                </div>

                                <!-- Payment Link Input -->
                                <div class="lg:w-2/3">
                                    <label for="base-payment-link" class="block text-sm font-bold text-gray-800 mb-2 flex items-center">
                                        <i data-lucide="link" class="w-4 h-4 mr-2 text-emerald-600"></i>
                                        Checkout Link (<span id="payment-type-label">Stripe</span>)
                                    </label>
                                    <input type="url" id="base-payment-link" class="w-full p-4 premium-input rounded-xl focus:ring-emerald-500 focus:border-emerald-500 font-medium" placeholder="e.g., https://checkout.stripe.com/c/pay/xxxxxxxx" required>
                                    <p class="text-xs text-gray-500 flex items-center mt-2">
                                        <i data-lucide="info" class="w-3 h-3 mr-1"></i>
                                        The base URL for your selected payment service. Service ID is appended for the final payment link.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Manage Services Panel -->
                <section class="admin-card p-8 rounded-3xl mb-8">
                    <div class="flex items-center mb-8">
                        <div class="w-14 h-14 premium-gradient rounded-xl flex items-center justify-center shadow-lg mr-4">
                            <i data-lucide="briefcase" class="w-7 h-7 text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-3xl font-black premium-heading">Manage Services</h2>
                            <p class="text-gray-600">Configure your booking services and pricing</p>
                        </div>
                    </div>

                    <!-- Service List Container -->
                    <div id="service-list" class="space-y-8">
                        <!-- Service Card Template -->
                        <div class="service-card p-6 rounded-2xl shadow-lg">
                            <div class="flex justify-between items-start mb-6">
                                <div>
                                    <h3 class="text-2xl font-bold premium-heading flex items-center">
                                        <i data-lucide="star" class="w-6 h-6 mr-3 text-emerald-600"></i>
                                        Premium Consultation
                                    </h3>
                                    <span class="inline-block px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm font-semibold mt-2">
                                        ID: svc_consult
                                    </span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="w-10 h-10 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition-colors flex items-center justify-center">
                                        <i data-lucide="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                <!-- Service Name -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-bold text-gray-800 flex items-center">
                                        <i data-lucide="tag" class="w-3 h-3 mr-2 text-emerald-600"></i>
                                        Service Name
                                    </label>
                                    <input type="text" value="Premium Consultation" class="w-full p-3 premium-input rounded-lg font-medium">
                                </div>
                                <!-- Duration -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-bold text-gray-800 flex items-center">
                                        <i data-lucide="clock" class="w-3 h-3 mr-2 text-emerald-600"></i>
                                        Duration (Min)
                                    </label>
                                    <input type="number" value="60" class="w-full p-3 premium-input rounded-lg font-medium">
                                </div>
                                <!-- Price -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-bold text-gray-800 flex items-center">
                                        <i data-lucide="dollar-sign" class="w-3 h-3 mr-2 text-emerald-600"></i>
                                        Price (USD)
                                    </label>
                                    <input type="number" value="199.00" class="w-full p-3 premium-input rounded-lg font-medium">
                                </div>
                                <!-- Meeting Link -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-bold text-gray-800 flex items-center">
                                        <i data-lucide="video" class="w-3 h-3 mr-2 text-emerald-600"></i>
                                        Meeting Link
                                    </label>
                                    <input type="url" value="https://zoom.us/j/1234567890" class="w-full p-3 premium-input rounded-lg font-medium" placeholder="e.g., https://zoom.us/j/...">
                                </div>
                            </div>
                            
                            <div class="mt-6 pt-4 border-t border-emerald-100">
                                <p class="text-xs text-gray-500 mb-4 flex items-center">
                                    <i data-lucide="info" class="w-3 h-3 mr-1"></i>
                                    Optional: Permanent link for virtual meetings. Leave blank for in-person services.
                                </p>
                                <div class="flex justify-end">
                                    <button class="btn-premium px-6 py-3 text-sm font-bold rounded-xl text-white shadow-lg flex items-center">
                                        <i data-lucide="save" class="w-4 h-4 mr-2"></i>
                                        Save Changes
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Add Service Button -->
                        <button id="add-service-btn" class="w-full border-3 border-dashed border-emerald-300 text-emerald-700 p-8 rounded-2xl flex items-center justify-center font-bold text-lg">
                            <div class="w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center mr-4">
                                <i data-lucide="plus" class="w-6 h-6"></i>
                            </div>
                            Add New Service
                        </button>
                    </div>
                </section>

                <!-- Global Save Button -->
                <div class="text-center py-8">
                    <button id="save-config-btn" class="btn-premium inline-flex items-center justify-center px-16 py-5 font-black text-xl rounded-2xl text-white shadow-2xl">
                        <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center mr-4">
                            <i data-lucide="save" class="w-5 h-5"></i>
                        </div>
                        Save All Configuration Changes
                    </button>
                </div>
            </div>

            <!-- Weekly Analytics Section -->
            <div id="analytics" class="section-content hidden">
                <div class="mb-8">
                    <h1 class="text-4xl font-black premium-heading mb-2">Weekly Analytics</h1>
                    <p class="text-gray-600 text-lg">Track your bookings and revenue performance</p>
                </div>

                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="admin-card p-6 rounded-2xl text-center">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="calendar-check" class="w-6 h-6 text-green-600"></i>
                        </div>
                        <h3 id="stat-bookings" class="text-2xl font-bold text-gray-900 mb-1">0</h3>
                        <p class="text-gray-600">Bookings This Week</p>
                    </div>
                    <div class="admin-card p-6 rounded-2xl text-center">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="dollar-sign" class="w-6 h-6 text-blue-600"></i>
                        </div>
                        <h3 id="stat-revenue" class="text-2xl font-bold text-gray-900 mb-1">$0</h3>
                        <p class="text-gray-600">Revenue This Week</p>
                    </div>
                    <div class="admin-card p-6 rounded-2xl text-center">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="trending-up" class="w-6 h-6 text-purple-600"></i>
                        </div>
                        <h3 id="stat-average" class="text-2xl font-bold text-gray-900 mb-1">$0</h3>
                        <p class="text-gray-600">Average Booking Value</p>
                    </div>
                    <div class="admin-card p-6 rounded-2xl text-center">
                        <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="clock" class="w-6 h-6 text-yellow-600"></i>
                        </div>
                        <h3 id="stat-period" class="text-2xl font-bold text-gray-900 mb-1">7 days</h3>
                        <p class="text-gray-600">Tracking Period</p>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="admin-card p-8 rounded-3xl">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Weekly Bookings</h3>
                        <div class="chart-container h-64 rounded-xl flex items-center justify-center">
                            <p class="text-gray-500">Chart placeholder - integrate with your preferred chart library</p>
                        </div>
                    </div>
                    <div class="admin-card p-8 rounded-3xl">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Revenue Breakdown</h3>
                        <div class="chart-container h-64 rounded-xl flex items-center justify-center">
                            <p class="text-gray-500">Chart placeholder - integrate with your preferred chart library</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar View Section -->
            <div id="calendar" class="section-content hidden">
                <div class="mb-8">
                    <h1 class="text-4xl font-black premium-heading mb-2">Calendar View</h1>
                    <p class="text-gray-600 text-lg">Full view of all your bookings and availability</p>
                </div>

                <!-- Calendar Controls -->
                <div class="admin-card p-6 rounded-2xl mb-8">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div class="flex items-center space-x-4">
                            <button onclick="previousCalendarMonth()" class="btn-secondary px-4 py-2 text-gray-700 rounded-lg font-semibold">
                                <i data-lucide="chevron-left" class="w-5 h-5"></i>
                            </button>
                            <h2 class="text-2xl font-bold text-gray-800" id="current-calendar-month">January 2025</h2>
                            <button onclick="nextCalendarMonth()" class="btn-secondary px-4 py-2 text-gray-700 rounded-lg font-semibold">
                                <i data-lucide="chevron-right" class="w-5 h-5"></i>
                            </button>
                        </div>
                        <div class="flex items-center space-x-3">
                            <button onclick="goToToday()" class="btn-premium px-4 py-2 text-white rounded-lg font-semibold text-sm">
                                <i data-lucide="calendar-days" class="w-4 h-4 mr-2 inline"></i>
                                Today
                            </button>
                            <select id="calendar-view" class="premium-input px-4 py-2 rounded-lg" onchange="changeCalendarView()">
                                <option value="month">Month View</option>
                                <option value="week">Week View</option>
                                <option value="day">Day View</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Legend -->
                <div class="admin-card p-4 rounded-xl mb-6">
                    <div class="flex flex-wrap items-center gap-6 text-sm">
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-emerald-500 rounded mr-2"></div>
                            <span class="text-gray-700">Confirmed Booking</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-yellow-500 rounded mr-2"></div>
                            <span class="text-gray-700">Pending Payment</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 bg-purple-500 rounded mr-2"></div>
                            <span class="text-gray-700">Holiday/Blocked</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 border-2 border-emerald-300 rounded mr-2"></div>
                            <span class="text-gray-700">Available</span>
                        </div>
                    </div>
                </div>

                <!-- Month View -->
                <div id="month-view" class="admin-card p-8 rounded-3xl">
                    <!-- Calendar Header -->
                    <div class="grid grid-cols-7 gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 mb-2">Sunday</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 mb-2">Monday</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 mb-2">Tuesday</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 mb-2">Wednesday</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 mb-2">Thursday</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 mb-2">Friday</div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 mb-2">Saturday</div>
                        </div>
                    </div>

                    <!-- Calendar Grid -->
                    <div class="grid grid-cols-7 gap-4" id="calendar-grid">
                        <!-- Calendar days will be populated here -->
                    </div>
                </div>

                <!-- Week View (Hidden by default) -->
                <div id="week-view" class="admin-card p-8 rounded-3xl hidden">
                    <div class="space-y-2" id="week-grid">
                        <!-- Week view will be populated here -->
                    </div>
                </div>

                <!-- Day View (Hidden by default) -->
                <div id="day-view" class="admin-card p-8 rounded-3xl hidden">
                    <div class="space-y-2" id="day-grid">
                        <!-- Day view will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Bookings Management Section -->
            <div id="bookings" class="section-content hidden">
                <div class="mb-8">
                    <h1 class="text-4xl font-black premium-heading mb-2">Manage Bookings</h1>
                    <p class="text-gray-600 text-lg">View and manage all customer bookings</p>
                </div>

                <!-- Booking Filters -->
                <div class="admin-card p-6 rounded-2xl mb-8">
                    <div class="flex flex-wrap gap-4">
                        <select class="premium-input px-4 py-2 rounded-lg">
                            <option>All Statuses</option>
                            <option>Confirmed</option>
                            <option>Pending</option>
                            <option>Cancelled</option>
                        </select>
                        <input type="date" class="premium-input px-4 py-2 rounded-lg">
                        <input type="text" placeholder="Search customer..." class="premium-input px-4 py-2 rounded-lg flex-1">
                        <button class="btn-premium px-4 py-2 text-white rounded-lg font-semibold">
                            <i data-lucide="search" class="w-4 h-4 mr-2 inline"></i>
                            Filter
                        </button>
                    </div>
                </div>

                <!-- Empty State Message -->
                <div class="admin-card p-12 rounded-3xl text-center">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="calendar-x" class="w-8 h-8 text-gray-400"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">No Bookings Yet</h3>
                    <p class="text-gray-500 mb-6">When customers make bookings, they'll appear here for you to manage.</p>
                    <button class="btn-premium px-6 py-3 text-white rounded-xl font-semibold">
                        <i data-lucide="refresh-cw" class="w-4 h-4 mr-2 inline"></i>
                        Sync with Calendar
                    </button>
                </div>
            </div>

            <!-- Business Hours Section -->
            <div id="availability" class="section-content hidden">
                <div class="mb-8">
                    <h1 class="text-4xl font-black premium-heading mb-2">Business Hours</h1>
                    <p class="text-gray-600 text-lg">Set your regular availability schedule</p>
                </div>

                <div class="admin-card p-8 rounded-3xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">Weekly Business Hours</h3>
                    
                    <div class="grid grid-cols-1 gap-4">
                        <!-- Days of the week -->
                        <div class="availability-available p-4 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <input type="checkbox" id="monday-enabled" checked class="w-5 h-5 text-emerald-600 rounded" onchange="toggleDayAvailability('monday')">
                                    <span class="font-bold text-gray-800 w-20">Monday</span>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <input type="time" id="monday-start" value="09:00" class="premium-input px-3 py-2 rounded-lg">
                                    <span class="text-gray-600">to</span>
                                    <input type="time" id="monday-end" value="17:00" class="premium-input px-3 py-2 rounded-lg">
                                </div>
                            </div>
                        </div>

                        <!-- Repeat for other days -->
                        <div class="availability-available p-4 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <input type="checkbox" id="tuesday-enabled" checked class="w-5 h-5 text-emerald-600 rounded" onchange="toggleDayAvailability('tuesday')">
                                    <span class="font-bold text-gray-800 w-20">Tuesday</span>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <input type="time" id="tuesday-start" value="09:00" class="premium-input px-3 py-2 rounded-lg">
                                    <span class="text-gray-600">to</span>
                                    <input type="time" id="tuesday-end" value="17:00" class="premium-input px-3 py-2 rounded-lg">
                                </div>
                            </div>
                        </div>

                        <div class="availability-available p-4 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <input type="checkbox" id="wednesday-enabled" checked class="w-5 h-5 text-emerald-600 rounded" onchange="toggleDayAvailability('wednesday')">
                                    <span class="font-bold text-gray-800 w-20">Wednesday</span>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <input type="time" id="wednesday-start" value="09:00" class="premium-input px-3 py-2 rounded-lg">
                                    <span class="text-gray-600">to</span>
                                    <input type="time" id="wednesday-end" value="17:00" class="premium-input px-3 py-2 rounded-lg">
                                </div>
                            </div>
                        </div>

                        <div class="availability-available p-4 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <input type="checkbox" id="thursday-enabled" checked class="w-5 h-5 text-emerald-600 rounded" onchange="toggleDayAvailability('thursday')">
                                    <span class="font-bold text-gray-800 w-20">Thursday</span>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <input type="time" id="thursday-start" value="09:00" class="premium-input px-3 py-2 rounded-lg">
                                    <span class="text-gray-600">to</span>
                                    <input type="time" id="thursday-end" value="17:00" class="premium-input px-3 py-2 rounded-lg">
                                </div>
                            </div>
                        </div>

                        <div class="availability-available p-4 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <input type="checkbox" id="friday-enabled" checked class="w-5 h-5 text-emerald-600 rounded" onchange="toggleDayAvailability('friday')">
                                    <span class="font-bold text-gray-800 w-20">Friday</span>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <input type="time" id="friday-start" value="09:00" class="premium-input px-3 py-2 rounded-lg">
                                    <span class="text-gray-600">to</span>
                                    <input type="time" id="friday-end" value="17:00" class="premium-input px-3 py-2 rounded-lg">
                                </div>
                            </div>
                        </div>

                        <div class="availability-blocked p-4 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <input type="checkbox" id="saturday-enabled" class="w-5 h-5 text-emerald-600 rounded" onchange="toggleDayAvailability('saturday')">
                                    <span class="font-bold text-gray-800 w-20">Saturday</span>
                                </div>
                                <div class="flex items-center space-x-4 opacity-50">
                                    <input type="time" id="saturday-start" disabled class="premium-input px-3 py-2 rounded-lg" value="09:00">
                                    <span class="text-gray-600">to</span>
                                    <input type="time" id="saturday-end" disabled class="premium-input px-3 py-2 rounded-lg" value="17:00">
                                </div>
                            </div>
                        </div>

                        <div class="availability-blocked p-4 rounded-xl">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <input type="checkbox" id="sunday-enabled" class="w-5 h-5 text-emerald-600 rounded" onchange="toggleDayAvailability('sunday')">
                                    <span class="font-bold text-gray-800 w-20">Sunday</span>
                                </div>
                                <div class="flex items-center space-x-4 opacity-50">
                                    <input type="time" id="sunday-start" disabled class="premium-input px-3 py-2 rounded-lg" value="09:00">
                                    <span class="text-gray-600">to</span>
                                    <input type="time" id="sunday-end" disabled class="premium-input px-3 py-2 rounded-lg" value="17:00">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end pt-6">
                        <button id="save-hours-btn" class="btn-premium px-8 py-3 text-white rounded-xl font-bold shadow-lg">
                            <i data-lucide="save" class="w-5 h-5 mr-2 inline"></i>
                            Save Business Hours
                        </button>
                    </div>
                </div>
            </div>

            <!-- Holidays Section -->
            <div id="holidays" class="section-content hidden">
                <div class="mb-8">
                    <h1 class="text-4xl font-black premium-heading mb-2">Holidays & Special Dates</h1>
                    <p class="text-gray-600 text-lg">Manage temporary blocks and special occasions</p>
                </div>

                <!-- Add Holiday Form -->
                <div class="admin-card p-8 rounded-3xl mb-8">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">Add Holiday Block</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-bold text-gray-800 mb-2">Holiday Name</label>
                            <input type="text" id="holiday-name" class="w-full p-3 premium-input rounded-lg" placeholder="e.g., Christmas Day">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-800 mb-2">Start Date</label>
                            <input type="date" id="holiday-start" class="w-full p-3 premium-input rounded-lg">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-800 mb-2">End Date</label>
                            <input type="date" id="holiday-end" class="w-full p-3 premium-input rounded-lg">
                        </div>
                    </div>
                    <div class="flex justify-end pt-6">
                        <button id="add-holiday-btn" class="btn-premium px-6 py-3 text-white rounded-xl font-semibold">
                            <i data-lucide="plus" class="w-4 h-4 mr-2 inline"></i>
                            Add Holiday Block
                        </button>
                    </div>
                </div>

                <!-- Holiday List -->
                <div id="holiday-list" class="space-y-4">
                    <!-- Holiday blocks will appear here -->
                </div>

                <!-- Empty State (shown when no holidays) -->
                <div id="holidays-empty-state" class="admin-card p-12 rounded-3xl text-center">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="calendar-plus" class="w-8 h-8 text-purple-600"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-700 mb-2">No Holiday Blocks Set</h3>
                    <p class="text-gray-500 mb-6">Add holiday periods or special date blocks to manage your availability.</p>
                </div>
            </div>

            <!-- Deployment & Embed Options Section -->
            <div id="deployment" class="section-content hidden">
                <div class="mb-8">
                    <h1 class="text-4xl font-black premium-heading mb-2">Deployment & Embed Options</h1>
                    <p class="text-gray-600 text-lg">Get your booking widget code to embed on your website</p>
                </div>

                <!-- Embed Code Options -->
                <div class="space-y-8">
                    <!-- iframe Embed -->
                    <div class="admin-card p-8 rounded-3xl">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center mr-4">
                                <i data-lucide="code" class="w-6 h-6 text-emerald-600"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">iframe Embed</h3>
                                <p class="text-gray-600">Simple iframe for basic embedding</p>
                            </div>
                        </div>
                        <div class="bg-gray-900 p-6 rounded-xl mb-4 overflow-x-auto">
                            <pre class="text-sm text-gray-200 font-mono" id="iframe-code"><span class="text-pink-400">&lt;iframe</span> <span class="text-blue-300">src</span>=<span class="text-green-300">"https://your-booking-widget.com/embed"</span> <span class="text-blue-300">width</span>=<span class="text-green-300">"100%"</span> <span class="text-blue-300">height</span>=<span class="text-green-300">"600"</span> <span class="text-blue-300">frameborder</span>=<span class="text-green-300">"0"</span><span class="text-pink-400">&gt;&lt;/iframe&gt;</span></pre>
                        </div>
                        <button onclick="copyToClipboard('iframe-code')" class="btn-premium px-4 py-2 text-white rounded-lg font-semibold text-sm">
                            <i data-lucide="copy" class="w-4 h-4 mr-2 inline"></i>
                            Copy Code
                        </button>
                    </div>

                    <!-- JavaScript Widget -->
                    <div class="admin-card p-8 rounded-3xl">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mr-4">
                                <i data-lucide="code-2" class="w-6 h-6 text-blue-600"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">JavaScript Widget</h3>
                                <p class="text-gray-600">Advanced widget with more customization options</p>
                            </div>
                        </div>
                        <div class="bg-gray-900 p-6 rounded-xl mb-4 overflow-x-auto">
                            <pre class="text-sm text-gray-200 font-mono leading-relaxed" id="js-code"><span class="text-pink-400">&lt;button</span> <span class="text-blue-300">id</span>=<span class="text-green-300">"swell-booking-modal-btn"</span><span class="text-pink-400">&gt;</span>Book a Session<span class="text-pink-400">&lt;/button&gt;</span>
<span class="text-pink-400">&lt;script&gt;</span><span class="text-gray-400">// See below for full script code to copy</span><span class="text-pink-400">&lt;/script&gt;</span></pre>
                        </div>
                        <button onclick="copyToClipboard('js-code')" class="btn-premium px-4 py-2 text-white rounded-lg font-semibold text-sm">
                            <i data-lucide="copy" class="w-4 h-4 mr-2 inline"></i>
                            Copy Code
                        </button>
                    </div>

                    <!-- WordPress Plugin -->
                    <div class="admin-card p-8 rounded-3xl">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mr-4">
                                <i data-lucide="plug" class="w-6 h-6 text-purple-600"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">WordPress Shortcode</h3>
                                <p class="text-gray-600">Easy shortcode for WordPress sites</p>
                            </div>
                        </div>
                        <div class="bg-gray-900 p-6 rounded-xl mb-4 overflow-x-auto">
                            <pre class="text-sm text-gray-200 font-mono" id="wp-code"><span class="text-yellow-300">[swell_booking</span> <span class="text-blue-300">width</span>=<span class="text-green-300">"100%"</span> <span class="text-blue-300">height</span>=<span class="text-green-300">"600px"</span> <span class="text-blue-300">theme</span>=<span class="text-green-300">"modern"</span><span class="text-yellow-300">]</span></pre>
                        </div>
                        <button onclick="copyToClipboard('wp-code')" class="btn-premium px-4 py-2 text-white rounded-lg font-semibold text-sm">
                            <i data-lucide="copy" class="w-4 h-4 mr-2 inline"></i>
                            Copy Code
                        </button>
                    </div>

                    <!-- Direct Link -->
                    <div class="admin-card p-8 rounded-3xl">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center mr-4">
                                <i data-lucide="external-link" class="w-6 h-6 text-orange-600"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Direct Link</h3>
                                <p class="text-gray-600">Standalone booking page link</p>
                            </div>
                        </div>
                        <div class="bg-gray-900 p-6 rounded-xl mb-4 overflow-x-auto">
                            <pre class="text-sm text-blue-300 font-mono" id="link-code">https://book.swellbooking.com/your-business-id</pre>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="copyToClipboard('link-code')" class="btn-premium px-4 py-2 text-white rounded-lg font-semibold text-sm">
                                <i data-lucide="copy" class="w-4 h-4 mr-2 inline"></i>
                                Copy Link
                            </button>
                            <button onclick="window.open(document.getElementById('link-code').textContent, '_blank')" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 text-white rounded-lg font-semibold text-sm transition-colors">
                                <i data-lucide="external-link" class="w-4 h-4 mr-2 inline"></i>
                                Open Link
                            </button>
                        </div>
                    </div>

                    <!-- Customization Options -->
                    <div class="admin-card p-8 rounded-3xl">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mr-4">
                                <i data-lucide="palette" class="w-6 h-6 text-green-600"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Customization Options</h3>
                                <p class="text-gray-600">Personalize your booking widget appearance</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold text-gray-800 mb-2">Primary Color</label>
                                <input type="color" id="widget-color" value="#065f46" class="w-full h-12 rounded-lg border border-gray-300">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-800 mb-2">Widget Theme</label>
                                <select id="widget-theme" class="w-full p-3 premium-input rounded-lg">
                                    <option value="modern">Modern</option>
                                    <option value="classic">Classic</option>
                                    <option value="minimal">Minimal</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-800 mb-2">Widget Width</label>
                                <select id="widget-width" class="w-full p-3 premium-input rounded-lg">
                                    <option value="100%">Full Width (100%)</option>
                                    <option value="800px">Fixed (800px)</option>
                                    <option value="600px">Compact (600px)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-800 mb-2">Widget Height</label>
                                <select id="widget-height" class="w-full p-3 premium-input rounded-lg">
                                    <option value="600px">Standard (600px)</option>
                                    <option value="500px">Compact (500px)</option>
                                    <option value="700px">Tall (700px)</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex justify-end pt-6">
                            <button onclick="updateEmbedCodes()" class="btn-premium px-6 py-3 text-white rounded-xl font-semibold">
                                <i data-lucide="refresh-cw" class="w-4 h-4 mr-2 inline"></i>
                                Update All Codes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state for managing data
        let holidays = [];
        let services = [];

        // Navigation functions
        function showSection(sectionId, element) {
            try {
                console.log('showSection called with:', sectionId, element);
                
                // Hide all sections
                const sections = document.querySelectorAll('.section-content');
                console.log('Found sections:', sections.length);
                sections.forEach(section => {
                    section.classList.add('hidden');
                });
                
                // Show selected section
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.remove('hidden');
                    console.log('Successfully showing section:', sectionId);
                } else {
                    console.error('Section not found:', sectionId);
                    return;
                }
                
                // Update sidebar active state
                const sidebarItems = document.querySelectorAll('.sidebar-item');
                sidebarItems.forEach(item => {
                    item.classList.remove('active');
                });
                
                // Set active state
                if (element) {
                    element.classList.add('active');
                    console.log('Set active element:', element);
                } else {
                    console.log('No element provided');
                }
                
            } catch (error) {
                console.error('Error in showSection:', error);
            }
        }

        // Payment processor functions
        function updatePaymentPlaceholder(type) {
            const placeholderMap = {
                'stripe': 'e.g., https://checkout.stripe.com/c/pay/xxxxxxxx',
                'square': 'e.g., https://squareup.com/checkout/xxxxx/xxxxxxx'
            };
            const label = type.charAt(0).toUpperCase() + type.slice(1);

            document.getElementById('base-payment-link').placeholder = placeholderMap[type];
            document.getElementById('payment-processor-type').value = type;
            document.getElementById('payment-type-label').textContent = label;
        }

        // Business hours functionality
        function toggleDayAvailability(day) {
            const enabled = document.getElementById(`${day}-enabled`).checked;
            const startInput = document.getElementById(`${day}-start`);
            const endInput = document.getElementById(`${day}-end`);
            const container = startInput.closest('.availability-blocked') || startInput.closest('.availability-available');
            
            if (enabled) {
                startInput.disabled = false;
                endInput.disabled = false;
                container.className = container.className.replace('availability-blocked', 'availability-available');
                container.querySelector('.flex.items-center.space-x-4:last-child').classList.remove('opacity-50');
            } else {
                startInput.disabled = true;
                endInput.disabled = true;
                container.className = container.className.replace('availability-available', 'availability-blocked');
                container.querySelector('.flex.items-center.space-x-4:last-child').classList.add('opacity-50');
            }
        }

        // Collect business hours data
        function getBusinessHours() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            const businessHours = {};
            
            days.forEach(day => {
                const enabled = document.getElementById(`${day}-enabled`);
                const start = document.getElementById(`${day}-start`);
                const end = document.getElementById(`${day}-end`);
                
                if (enabled && start && end) {
                    businessHours[day] = {
                        enabled: enabled.checked,
                        start: start.value,
                        end: end.value
                    };
                }
            });
            
            return businessHours;
        }

        // Holiday management
        function addHoliday() {
            const name = document.getElementById('holiday-name').value.trim();
            const start = document.getElementById('holiday-start').value;
            const end = document.getElementById('holiday-end').value;
            
            if (!name || !start || !end) {
                alert('Please fill in all holiday fields');
                return;
            }
            
            const holiday = {
                id: 'holiday_' + Date.now(),
                name: name,
                startDate: start,
                endDate: end
            };
            
            holidays.push(holiday);
            renderHolidays();
            
            // Clear form
            document.getElementById('holiday-name').value = '';
            document.getElementById('holiday-start').value = '';
            document.getElementById('holiday-end').value = '';
        }

        function removeHoliday(id) {
            holidays = holidays.filter(h => h.id !== id);
            renderHolidays();
        }

        function renderHolidays() {
            const container = document.getElementById('holiday-list');
            const emptyState = document.getElementById('holidays-empty-state');
            
            if (holidays.length === 0) {
                container.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            container.innerHTML = holidays.map(holiday => `
                <div class="admin-card p-6 rounded-2xl availability-holiday">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-bold text-gray-800 mb-2">${holiday.name}</h3>
                            <p class="text-gray-600">
                                <i data-lucide="calendar" class="w-4 h-4 inline mr-2"></i>
                                ${formatDate(holiday.startDate)} to ${formatDate(holiday.endDate)}
                            </p>
                        </div>
                        <button onclick="removeHoliday('${holiday.id}')" class="w-10 h-10 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition-colors flex items-center justify-center">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Re-create icons for new elements
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        // Form validation
        function validateConfiguration() {
            const calendarId = document.getElementById('calendar-id').value.trim();
            const adminEmail = document.getElementById('admin-email').value.trim();
            const paymentLink = document.getElementById('base-payment-link').value.trim();
            
            if (!calendarId) {
                alert('Please enter a Google Calendar ID');
                return false;
            }
            
            if (!adminEmail || !adminEmail.includes('@')) {
                alert('Please enter a valid admin email');
                return false;
            }
            
            if (!paymentLink || !paymentLink.startsWith('http')) {
                alert('Please enter a valid payment link');
                return false;
            }
            
            return true;
        }

        // Load configuration from backend
        async function loadConfiguration() {
            try {
                const response = await fetch(window.location.origin + window.location.pathname, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'getConfiguration' })
                });
                
                const data = await response.json();
                
                if (data.success && data.config) {
                    const config = data.config;
                    
                    // Populate form fields
                    if (config.calendarId) document.getElementById('calendar-id').value = config.calendarId;
                    if (config.adminEmail) document.getElementById('admin-email').value = config.adminEmail;
                    if (config.basePaymentLink) document.getElementById('base-payment-link').value = config.basePaymentLink;
                    if (config.paymentProcessor) document.getElementById('payment-processor-type').value = config.paymentProcessor;
                    
                    // Load business hours
                    if (config.businessHours && Object.keys(config.businessHours).length > 0) {
                        loadBusinessHoursFromConfig(config.businessHours);
                    }
                    
                    // Load holidays
                    if (config.holidays && config.holidays.length > 0) {
                        holidays = config.holidays;
                        renderHolidays();
                    }
                    
                    // Load services
                    if (config.services && config.services.length > 0) {
                        services = config.services;
                    }
                    
                    console.log('Configuration loaded successfully');
                } else {
                    console.warn('No configuration found or error:', data.error);
                }
            } catch (error) {
                console.error('Error loading configuration:', error);
            }
        }

        // Helper function to load business hours from config
        function loadBusinessHoursFromConfig(businessHours) {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            days.forEach(day => {
                if (businessHours[day]) {
                    const enabled = businessHours[day].enabled;
                    const start = businessHours[day].start;
                    const end = businessHours[day].end;
                    
                    document.getElementById(`${day}-enabled`).checked = enabled;
                    document.getElementById(`${day}-start`).value = start;
                    document.getElementById(`${day}-end`).value = end;
                }
            });
        }

        // Save configuration with comprehensive data collection
        async function saveConfiguration() {
            if (!validateConfiguration()) return;
            
            const configData = {
                calendarId: document.getElementById('calendar-id').value.trim(),
                adminEmail: document.getElementById('admin-email').value.trim(),
                basePaymentLink: document.getElementById('base-payment-link').value.trim(),
                paymentProcessorType: document.getElementById('payment-processor-type').value,
                businessHours: getBusinessHours(),
                holidays: holidays,
                services: services,
                timestamp: new Date().toISOString()
            };

            try {
                const response = await fetch(window.location.origin + window.location.pathname, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        action: 'saveConfiguration',
                        config: configData
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showSuccessMessage('Configuration saved successfully!');
                    console.log('Configuration saved to backend');
                } else {
                    showErrorMessage('Failed to save configuration: ' + data.error);
                }
            } catch (error) {
                console.error('Error saving configuration:', error);
                showErrorMessage('Error saving configuration: ' + error.message);
            }
        }

        // Save business hours
        async function saveBusinessHours() {
            const businessHours = getBusinessHours();
            
            try {
                const response = await fetch(window.location.origin + window.location.pathname, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        action: 'saveBusinessHours',
                        businessHours: businessHours
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showSuccessMessage('Business hours saved successfully!');
                } else {
                    showErrorMessage('Failed to save business hours: ' + data.error);
                }
            } catch (error) {
                console.error('Error saving business hours:', error);
                showErrorMessage('Error saving business hours: ' + error.message);
            }
        }

        // Success message helper
        function showSuccessMessage(message) {
            // Create a temporary success notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 status-success px-6 py-4 rounded-xl shadow-lg z-50';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i data-lucide="check-circle" class="w-5 h-5 mr-3"></i>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Re-create icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Error message helper
        function showErrorMessage(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-red-100 text-red-800 px-6 py-4 rounded-xl shadow-lg z-50 border-2 border-red-200';
            notification.innerHTML = `
                <div class="flex items-center">
                    <i data-lucide="alert-circle" class="w-5 h-5 mr-3"></i>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Deployment & Embed Functions
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            // Get the text content (strips HTML tags)
            const text = element.textContent.trim();
            
            // Use modern clipboard API if available
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    showSuccessMessage('Code copied to clipboard!');
                }).catch(() => {
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            // Fallback for older browsers
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                showSuccessMessage('Code copied to clipboard!');
            } catch (err) {
                showSuccessMessage('Failed to copy code. Please copy manually.');
            }
            document.body.removeChild(textarea);
        }

        // Load user information from Google session
        function loadUserInfo() {
            try {
                // Try to get email from template variable first
                const templateEmail = '<?= userEmail ?>';
                
                if (templateEmail && templateEmail !== '<?= userEmail ?>' && templateEmail.includes('@')) {
                    // We have the email from the server
                    const userEmail = templateEmail;
                    
                    // Extract name from email (before @) and format it nicely
                    let userName = userEmail.split('@')[0];
                    userName = userName.replace(/[._-]/g, ' ')
                        .split(' ')
                        .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
                        .join(' ');
                    
                    // Update UI elements
                    document.getElementById('user-name').textContent = userName;
                    document.getElementById('user-email').textContent = userEmail;
                    
                    // Try to load user's Google profile picture
                    // Using Google's profile image URL format
                    const emailHash = userEmail.toLowerCase().trim();
                    
                    // Try Google profile picture first
                    const googlePhotoUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(userName)}&size=40&background=10b981&color=fff&bold=true`;
                    
                    const avatar = document.getElementById('user-avatar');
                    const placeholder = document.getElementById('user-avatar-placeholder');
                    
                    if (avatar && placeholder) {
                        avatar.onload = function() {
                            placeholder.style.display = 'none';
                            avatar.style.display = 'block';
                        };
                        avatar.onerror = function() {
                            // Keep placeholder if avatar fails to load
                            placeholder.style.display = 'flex';
                            avatar.style.display = 'none';
                        };
                        
                        avatar.src = googlePhotoUrl;
                    }
                } else {
                    // Fallback if no email from template - try to get from config
                    console.log('Template email not found, fetching from configuration...');
                    
                    // Make API call to get admin email
                    fetch(window.location.origin + window.location.pathname, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ action: 'getConfiguration' })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success && data.config && data.config.adminEmail) {
                            const userEmail = data.config.adminEmail;
                            
                            // Extract name from email
                            let userName = userEmail.split('@')[0];
                            userName = userName.replace(/[._-]/g, ' ')
                                .split(' ')
                                .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
                                .join(' ');
                            
                            document.getElementById('user-name').textContent = userName;
                            document.getElementById('user-email').textContent = userEmail;
                            
                            // Update avatar
                            const googlePhotoUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(userName)}&size=40&background=10b981&color=fff&bold=true`;
                            const avatar = document.getElementById('user-avatar');
                            const placeholder = document.getElementById('user-avatar-placeholder');
                            
                            if (avatar && placeholder) {
                                avatar.onload = function() {
                                    placeholder.style.display = 'none';
                                    avatar.style.display = 'block';
                                };
                                avatar.src = googlePhotoUrl;
                            }
                        } else {
                            // Final fallback
                            document.getElementById('user-name').textContent = 'Admin User';
                            document.getElementById('user-email').textContent = 'Administrator';
                        }
                    })
                    .catch(error => {
                        console.error('Failed to fetch admin email:', error);
                        document.getElementById('user-name').textContent = 'Admin User';
                        document.getElementById('user-email').textContent = 'Administrator';
                    });
                }
            } catch (error) {
                console.error('Error loading user info:', error);
                // Fallback values
                document.getElementById('user-name').textContent = 'Admin User';
                document.getElementById('user-email').textContent = 'Administrator';
            }
        }

        function updateEmbedCodes() {
            const color = document.getElementById('widget-color').value;
            const theme = document.getElementById('widget-theme').value;
            const width = document.getElementById('widget-width').value;
            const height = document.getElementById('widget-height').value;
            
            // Update iframe code with styling
            const iframeCode = '<span class="text-pink-400">&lt;iframe</span> <span class="text-blue-300">src</span>=<span class="text-green-300">"https://your-booking-widget.com/embed?theme=' + theme + '&color=' + encodeURIComponent(color) + '"</span> <span class="text-blue-300">width</span>=<span class="text-green-300">"' + width + '"</span> <span class="text-blue-300">height</span>=<span class="text-green-300">"' + height + '"</span> <span class="text-blue-300">frameborder</span>=<span class="text-green-300">"0"</span><span class="text-pink-400">&gt;&lt;/iframe&gt;</span>';
            document.getElementById('iframe-code').innerHTML = iframeCode;
            
            // Update JavaScript code with styling (simplified for display)
            const jsCode = '<span class="text-pink-400">&lt;button</span> <span class="text-blue-300">id</span>=<span class="text-green-300">"swell-booking-modal-btn"</span><span class="text-pink-400">&gt;</span>Book a Session<span class="text-pink-400">&lt;/button&gt;</span>\n<span class="text-pink-400">&lt;script&gt;</span><span class="text-gray-400">// See below for full script code to copy</span><span class="text-pink-400">&lt;/script&gt;</span>';
            document.getElementById('js-code').innerHTML = jsCode;
            
            // Update WordPress shortcode with styling
            const wpCode = '<span class="text-yellow-300">[swell_booking</span> <span class="text-blue-300">width</span>=<span class="text-green-300">"' + width + '"</span> <span class="text-blue-300">height</span>=<span class="text-green-300">"' + height + '"</span> <span class="text-blue-300">theme</span>=<span class="text-green-300">"' + theme + '"</span> <span class="text-blue-300">color</span>=<span class="text-green-300">"' + color + '"</span><span class="text-yellow-300">]</span>';
            document.getElementById('wp-code').innerHTML = wpCode;
            
            showSuccessMessage('All embed codes updated with your customizations!');
        }

        // Calendar Functions
        let currentCalendarDate = new Date();
        let calendarView = 'month';
        let calendarBookings = [];

        // Load bookings from Google Calendar via API
        async function loadCalendarBookings() {
            try {
                const startDate = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth(), 1);
                const endDate = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth() + 1, 0);
                
                const response = await fetch(window.location.origin + window.location.pathname, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'getBookings',
                        filters: {
                            startDate: startDate.toISOString(),
                            endDate: endDate.toISOString()
                        }
                    })
                });
                
                const data = await response.json();
                
                if (data.success && data.bookings) {
                    // Transform bookings to match calendar format
                    calendarBookings = data.bookings.map(booking => ({
                        id: booking.id,
                        title: booking.title,
                        date: new Date(booking.start),
                        endDate: new Date(booking.end),
                        duration: Math.round((new Date(booking.end) - new Date(booking.start)) / 60000),
                        status: 'confirmed',
                        description: booking.description,
                        location: booking.location,
                        guests: booking.guests
                    }));
                    
                    renderCalendar();
                    console.log('Loaded ' + calendarBookings.length + ' bookings from calendar');
                } else {
                    console.error('Failed to load bookings:', data.error);
                    calendarBookings = [];
                }
            } catch (error) {
                console.error('Error loading calendar bookings:', error);
                calendarBookings = [];
            }
        }

        // Load analytics data from API
        async function loadAnalytics() {
            try {
                // Get last 7 days of data
                const endDate = new Date();
                const startDate = new Date();
                startDate.setDate(startDate.getDate() - 7);
                
                const response = await fetch(window.location.origin + window.location.pathname, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'getAnalytics',
                        startDate: startDate.toISOString(),
                        endDate: endDate.toISOString()
                    })
                });
                
                const data = await response.json();
                
                if (data.success && data.analytics) {
                    const analytics = data.analytics;
                    
                    // Update stat cards
                    document.getElementById('stat-bookings').textContent = analytics.totalBookings || 0;
                    document.getElementById('stat-revenue').textContent = '$' + (analytics.totalRevenue || 0).toFixed(0);
                    document.getElementById('stat-average').textContent = '$' + (analytics.averageBookingValue || 0).toFixed(0);
                    
                    console.log('Loaded analytics:', analytics);
                } else {
                    console.error('Failed to load analytics:', data.error);
                    // Set default values
                    document.getElementById('stat-bookings').textContent = '0';
                    document.getElementById('stat-revenue').textContent = '$0';
                    document.getElementById('stat-average').textContent = '$0';
                }
            } catch (error) {
                console.error('Error loading analytics:', error);
                // Set default values
                document.getElementById('stat-bookings').textContent = '0';
                document.getElementById('stat-revenue').textContent = '$0';
                document.getElementById('stat-average').textContent = '$0';
            }
        }

        function renderCalendar() {
            updateCalendarHeader();
            
            if (calendarView === 'month') {
                renderMonthView();
            } else if (calendarView === 'week') {
                renderWeekView();
            } else {
                renderDayView();
            }
        }

        function updateCalendarHeader() {
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'];
            const headerText = `${monthNames[currentCalendarDate.getMonth()]} ${currentCalendarDate.getFullYear()}`;
            document.getElementById('current-calendar-month').textContent = headerText;
        }

        function renderMonthView() {
            const grid = document.getElementById('calendar-grid');
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            let html = '';
            
            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="min-h-32 p-2 border-2 border-gray-100 rounded-xl bg-gray-50"></div>';
            }
            
            // Days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateString = date.toISOString().split('T')[0];
                const isToday = date.toDateString() === today.toDateString();
                
                // Get bookings for this day
                const dayBookings = calendarBookings.filter(booking => {
                    const bookingDate = new Date(booking.date);
                    return bookingDate.getFullYear() === year &&
                           bookingDate.getMonth() === month &&
                           bookingDate.getDate() === day;
                });
                
                // Check if it's a holiday
                const isHoliday = holidays.some(h => {
                    const start = new Date(h.startDate);
                    const end = new Date(h.endDate);
                    return date >= start && date <= end;
                });
                
                let bgClass = 'bg-white border-emerald-100';
                if (isToday) {
                    bgClass = 'bg-emerald-50 border-emerald-400';
                }
                if (isHoliday) {
                    bgClass = 'bg-purple-50 border-purple-300';
                }
                
                html += `
                    <div class="min-h-32 p-2 border-2 ${bgClass} rounded-xl overflow-hidden hover:shadow-lg transition-shadow cursor-pointer" onclick="showDayDetails('${dateString}')">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-lg font-bold ${isToday ? 'text-emerald-700' : 'text-gray-800'}">${day}</span>
                            ${dayBookings.length > 0 ? `<span class="text-xs bg-emerald-500 text-white px-2 py-1 rounded-full font-bold">${dayBookings.length}</span>` : ''}
                        </div>
                        <div class="space-y-1">
                            ${dayBookings.slice(0, 3).map(booking => {
                                const time = booking.date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                                const statusColor = booking.status === 'confirmed' ? 'bg-emerald-500' : 'bg-yellow-500';
                                return `
                                    <div class="${statusColor} text-white text-xs p-2 rounded-lg font-medium truncate">
                                        <div class="flex items-center">
                                            <i data-lucide="clock" class="w-3 h-3 mr-1"></i>
                                            ${time}
                                        </div>
                                        <div class="truncate">${booking.customer}</div>
                                    </div>
                                `;
                            }).join('')}
                            ${dayBookings.length > 3 ? `<div class="text-xs text-gray-600 text-center">+${dayBookings.length - 3} more</div>` : ''}
                        </div>
                        ${isHoliday ? '<div class="mt-2 text-xs text-purple-700 font-semibold flex items-center"><i data-lucide="alert-circle" class="w-3 h-3 mr-1"></i>Holiday</div>' : ''}
                    </div>
                `;
            }
            
            grid.innerHTML = html;
            
            // Re-create icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function renderWeekView() {
            const grid = document.getElementById('week-grid');
            const startOfWeek = new Date(currentCalendarDate);
            startOfWeek.setDate(currentCalendarDate.getDate() - currentCalendarDate.getDay());
            
            let html = '<div class="space-y-2">';
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                const dayName = date.toLocaleDateString('en-US', { weekday: 'long' });
                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                
                const dayBookings = calendarBookings.filter(booking => {
                    const bookingDate = new Date(booking.date);
                    return bookingDate.toDateString() === date.toDateString();
                });
                
                html += `
                    <div class="border-2 border-emerald-100 rounded-xl p-4 bg-white">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h3 class="text-lg font-bold text-gray-800">${dayName}</h3>
                                <p class="text-sm text-gray-600">${dateStr}</p>
                            </div>
                            <span class="text-xs bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full font-bold">${dayBookings.length} bookings</span>
                        </div>
                        <div class="space-y-2">
                            ${dayBookings.length > 0 ? dayBookings.map(booking => {
                                const time = booking.date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                                const statusColor = booking.status === 'confirmed' ? 'bg-emerald-500' : 'bg-yellow-500';
                                return `
                                    <div class="${statusColor} text-white p-3 rounded-lg">
                                        <div class="flex justify-between items-start mb-2">
                                            <div>
                                                <div class="text-lg font-bold">${booking.customer}</div>
                                                <div class="text-sm opacity-90">${booking.service}</div>
                                            </div>
                                            <div class="text-right">
                                                <div class="font-bold">${time}</div>
                                                <div class="text-sm opacity-90">${booking.duration} min</div>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('') : '<p class="text-gray-500 text-center py-4">No bookings scheduled</p>'}
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            grid.innerHTML = html;
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function renderDayView() {
            const grid = document.getElementById('day-grid');
            const dayName = currentCalendarDate.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
            
            const dayBookings = calendarBookings.filter(booking => {
                const bookingDate = new Date(booking.date);
                return bookingDate.toDateString() === currentCalendarDate.toDateString();
            }).sort((a, b) => a.date - b.date);
            
            let html = `
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">${dayName}</h2>
                    <p class="text-gray-600">${dayBookings.length} booking${dayBookings.length !== 1 ? 's' : ''} scheduled</p>
                </div>
                <div class="space-y-4">
            `;
            
            // Time slots from 8 AM to 8 PM
            for (let hour = 8; hour <= 20; hour++) {
                const timeStr = `${hour > 12 ? hour - 12 : hour}:00 ${hour >= 12 ? 'PM' : 'AM'}`;
                const bookingsAtTime = dayBookings.filter(booking => {
                    return booking.date.getHours() === hour;
                });
                
                html += `
                    <div class="flex border-2 border-gray-100 rounded-xl overflow-hidden">
                        <div class="w-24 bg-emerald-50 p-4 flex items-start justify-center border-r-2 border-emerald-200">
                            <span class="font-bold text-gray-700">${timeStr}</span>
                        </div>
                        <div class="flex-1 p-4">
                            ${bookingsAtTime.length > 0 ? bookingsAtTime.map(booking => {
                                const time = booking.date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
                                const statusColor = booking.status === 'confirmed' ? 'bg-emerald-500' : 'bg-yellow-500';
                                const statusText = booking.status === 'confirmed' ? 'Confirmed' : 'Pending Payment';
                                return `
                                    <div class="${statusColor} text-white p-4 rounded-lg">
                                        <div class="flex justify-between items-start mb-2">
                                            <div>
                                                <div class="text-lg font-bold">${booking.customer}</div>
                                                <div class="opacity-90">${booking.email}</div>
                                            </div>
                                            <span class="bg-white/20 px-3 py-1 rounded-full text-sm font-semibold">${statusText}</span>
                                        </div>
                                        <div class="grid grid-cols-3 gap-4 mt-3 pt-3 border-t border-white/20">
                                            <div>
                                                <div class="text-xs opacity-75">Service</div>
                                                <div class="font-semibold">${booking.service}</div>
                                            </div>
                                            <div>
                                                <div class="text-xs opacity-75">Time</div>
                                                <div class="font-semibold">${time}</div>
                                            </div>
                                            <div>
                                                <div class="text-xs opacity-75">Duration</div>
                                                <div class="font-semibold">${booking.duration} min</div>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('') : '<p class="text-gray-400 italic">No bookings</p>'}
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            grid.innerHTML = html;
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function previousCalendarMonth() {
            if (calendarView === 'month') {
                currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
            } else if (calendarView === 'week') {
                currentCalendarDate.setDate(currentCalendarDate.getDate() - 7);
            } else {
                currentCalendarDate.setDate(currentCalendarDate.getDate() - 1);
            }
            loadCalendarBookings(); // Reload bookings for new date range
        }

        function nextCalendarMonth() {
            if (calendarView === 'month') {
                currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
            } else if (calendarView === 'week') {
                currentCalendarDate.setDate(currentCalendarDate.getDate() + 7);
            } else {
                currentCalendarDate.setDate(currentCalendarDate.getDate() + 1);
            }
            loadCalendarBookings(); // Reload bookings for new date range
        }

        function goToToday() {
            currentCalendarDate = new Date();
            loadCalendarBookings(); // Reload bookings for current month
        }

        function changeCalendarView() {
            const viewSelect = document.getElementById('calendar-view');
            calendarView = viewSelect.value;
            
            // Hide all views
            document.getElementById('month-view').classList.add('hidden');
            document.getElementById('week-view').classList.add('hidden');
            document.getElementById('day-view').classList.add('hidden');
            
            // Show selected view
            if (calendarView === 'month') {
                document.getElementById('month-view').classList.remove('hidden');
            } else if (calendarView === 'week') {
                document.getElementById('week-view').classList.remove('hidden');
            } else {
                document.getElementById('day-view').classList.remove('hidden');
            }
            
            renderCalendar();
        }

        function showDayDetails(dateString) {
            const date = new Date(dateString + 'T00:00:00');
            currentCalendarDate = date;
            document.getElementById('calendar-view').value = 'day';
            changeCalendarView();
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM Content Loaded - Initializing admin panel');
            
            // Initialize icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
                console.log('Lucide icons initialized');
            }
            
            // Make showSection globally available
            window.showSection = showSection;
            console.log('showSection made globally available');
            
            // Test the function
            console.log('Testing showSection function:', typeof window.showSection);
            
            // Add event listeners
            const saveConfigBtn = document.getElementById('save-config-btn');
            const saveHoursBtn = document.getElementById('save-hours-btn');
            const addHolidayBtn = document.getElementById('add-holiday-btn');
            
            if (saveConfigBtn) {
                saveConfigBtn.addEventListener('click', saveConfiguration);
                console.log('Save config button listener added');
            }
            
            if (saveHoursBtn) {
                saveHoursBtn.addEventListener('click', saveBusinessHours);
                console.log('Save hours button listener added');
            }
            
            if (addHolidayBtn) {
                addHolidayBtn.addEventListener('click', addHoliday);
                console.log('Add holiday button listener added');
            }
            
            // Initialize empty states
            renderHolidays();
            
            // Initialize calendar (will render when section is shown)
            renderCalendar();
            
            // Load user information
            loadUserInfo();
            
            // Load real data from backend
            loadConfiguration();
            loadCalendarBookings();
            loadAnalytics();
            
            console.log('Admin panel initialization complete');
        });
    </script>

</body>
</html>
